<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>1ª Prova Intensivo 4 — Fundação de Cultura, Difusão e Estudos Brasileiros</title>
  <style>
    :root{
      --accent:#005c99;
      --muted:#666;
      --paper:#fff;
      --bg:#f5f7fb;
      --card:#ffffff;
      --radius:10px;
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:24px;
      color:#222;
    }
    .container{
      max-width:940px;
      margin:0 auto;
    }
    header.card{
      background:linear-gradient(90deg, rgba(0,92,153,0.06), rgba(0,92,153,0.02));
      padding:18px 20px;
      border-radius:var(--radius);
      display:flex;
      gap:20px;
      align-items:center;
      margin-bottom:18px;
    }
    header .title{
      font-size:16px;
      font-weight:700;
      color:var(--accent);
    }
    header .meta{font-size:13px;color:var(--muted)}
    form.card{
      background:var(--card);
      padding:18px 20px;
      border-radius:var(--radius);
      box-shadow: 0 6px 18px rgba(15,30,50,0.04);
      margin-bottom:18px;
    }
    label{display:block;font-weight:600;margin-bottom:6px}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .field{flex:1;min-width:160px}
    input[type="text"], input[type="date"], select, textarea{
      width:100%;
      box-sizing:border-box;
      padding:10px 12px;
      border-radius:8px;
      border:1px solid #d6dce6;
      font-size:14px;
      background:#fff;
      resize:vertical;
    }
    textarea{min-height:220px;line-height:1.45}
    .instructions{background:#f0f6fb;border-left:4px solid var(--accent);padding:10px 12px;border-radius:6px;margin-bottom:12px;color:var(--muted)}
    h2.section{margin:8px 0 14px 0;font-size:16px;color:var(--accent)}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    button{
      background:var(--accent);
      color:white;border:0;padding:10px 14px;border-radius:8px;font-weight:600;cursor:pointer;
      box-shadow: 0 4px 10px rgba(0,92,153,0.12);
    }
    button.secondary{background:#6b7280}
    button.ghost{background:transparent;color:var(--accent);border:1px solid rgba(0,92,153,0.12);box-shadow:none}
    .hint{font-size:13px;color:var(--muted);margin-top:8px}
    .small{font-size:13px;color:var(--muted)}
    .result{margin-top:12px;padding:10px;border-radius:8px}
    .ok{background:#eefdf6;color:#054e2d;border:1px solid #c6f2d8}
    .warn{background:#fff7e6;color:#6a4a00;border:1px solid #ffe7a8}
    .error{background:#fff2f2;color:#7a1717;border:1px solid #ffc6c6}
    @media print{
      body{padding:6mm;background:white}
      .controls, header .meta, .no-print{display:none}
      .card{box-shadow:none; border-radius:0}
      textarea{min-height:140px}
    }
    footer{font-size:13px;color:var(--muted);text-align:center;margin-top:8px}
    .counter{font-size:12px;color:var(--muted);float:right}
  </style>
</head>
<body>
  <div class="container">
    <header class="card" role="banner">
      <div style="flex:1">
        <div class="title">Fundação de Cultura, Difusão e Estudos Brasileiros</div>
        <div class="meta">1ª Prova Intensivo 5 — Modelo digital</div>
      </div>
      <div class="meta no-print" aria-hidden="true">
        <div>Imprimir: <button class="ghost" type="button" onclick="window.print()">Salvar / Imprimir</button></div>
      </div>
    </header>

    <form id="provaForm" class="card" autocomplete="off" onsubmit="return false;">
      <div class="row">
        <div class="field">
          <label for="aluno">Aluno</label>
          <input id="aluno" name="aluno" type="text" placeholder="Nome completo" required />
        </div>
        <div class="field">
          <label for="professor">Professor</label>
          <input id="professor" name="professor" type="text" placeholder="Nome do professor" />
        </div>
        <div class="field">
          <label for="data">Data</label>
          <input id="data" name="data" type="date" />
        </div>
      </div>

      <div class="instructions" role="note">
        <strong>Instruções:</strong>
        <ol style="margin:6px 0 0 18px;padding:0;color:var(--muted)">
          <li>Leia todas as questões antes de responder.</li>
          <li>Responda nos campos indicados. Em versão impressa, escreva com letra legível.</li>
          <li>Uso de corretivo não é permitido.</li>
          <li>Questão 1: use o <em>presente do subjuntivo</em>. Questão 2: utilize pelo menos 2 vezes o <em>pretérito mais-que-perfeito composto</em>.</li>
        </ol>
      </div>

      <section aria-labelledby="q1">
        <h2 class="section" id="q1">Questão 1 — Produção de Texto</h2>
        <label for="texto1">Leia a proposta sobre a cultura da pressa no mundo do trabalho. Imagine que você trabalha no Departamento de Recursos Humanos e escreva um e-mail aos funcionários sobre a importância de equilibrar vida pessoal e trabalho. Use o presente do subjuntivo e conectores (recomendo que, é importante que, para que, embora, etc.).</label>
        <div style="position:relative">
          <div class="counter" id="counter1">0 / 1500</div>
          <textarea id="texto1" name="texto1" placeholder="Escreva aqui o e-mail..." maxlength="5000" required></textarea>
        </div>
        <div class="hint small">Dica: procure usar expressões como <em>recomendo que</em>, <em>é importante que</em> e conjugações no presente do subjuntivo (ex.: que eu faça; que ele trabalhe).</div>
      </section>

      <section aria-labelledby="q2" style="margin-top:14px">
        <h2 class="section" id="q2">Questão 2 — Pretérito Mais-que-Perfeito Composto</h2>
        <label for="q2a">a) Quando seu pai chegou do trabalho ele estava desanimado. Por quê?</label>
        <textarea id="q2a" name="q2a" placeholder="Resposta a)" rows="3" required></textarea>

        <label for="q2b" style="margin-top:10px">b) Quando vocês vieram discutir os planos para nossa viagem, não conseguimos chegar a um denominador comum. Por quê?</label>
        <textarea id="q2b" name="q2b" placeholder="Resposta b)" rows="3" required></textarea>

        <label for="q2c" style="margin-top:10px">c) Você e eu íamos jantar juntos ontem, mas você não apareceu. Por quê?</label>
        <textarea id="q2c" name="q2c" placeholder="Resposta c)" rows="3" required></textarea>

        <div class="hint small">A página tentará verificar se você usou o pretérito mais-que-perfeito composto pelo menos duas vezes entre as três respostas. Essa verificação é aproximada — revisões manuais do professor ainda são recomendadas.</div>
      </section>

      <div class="controls no-print" style="margin-top:14px">
        <button type="button" onclick="validar()">Verificar</button>
        <button class="secondary" type="button" onclick="baixarJSON()">Salvar respostas (JSON)</button>
        <button class="ghost" type="button" onclick="window.print()">Imprimir / Salvar como PDF</button>
        <button class="secondary" type="button" onclick="limpar()">Limpar</button>
      </div>

      <div id="feedback" aria-live="polite"></div>
    </form>

    <footer>
      Proibida a reprodução parcial ou total deste documento. Propriedade da Fundação de Cultura, Difusão e Estudos Brasileiros.
    </footer>
  </div>

  <script>
    // contador de caracteres para o texto 1
    const t1 = document.getElementById('texto1');
    const c1 = document.getElementById('counter1');
    t1.addEventListener('input', () => {
      c1.textContent = `${t1.value.length} / 1500`;
    });

    // heurística simples para detectar mais-que-perfeito composto
    // Procuramos por padrões como "tinha|tinham|tínhamos|tinha" + particípio (termina em ado/ido/to/cho/ado/ido)
    function contarMaisQuePerfeito(texto) {
      if (!texto) return 0;
      // normalizar
      const s = texto.toLowerCase();
      // regex básico: (tinha|tinham|tínhamos|tinha) <1-3 palavras> <particípio>
      const regex = /\b(tinha|tinham|tínhamos|tinha|tivera|tiveram|havia|haviam)\b(?:\s+\w{1,20}){0,3}\s+\b\w+(ado|ido|to|cho|ado|ido)\b/gi;
      const matches = s.match(regex);
      return matches ? matches.length : 0;
    }

    // função validar
    function validar() {
      const feedback = document.getElementById('feedback');
      feedback.innerHTML = '';
      const q2a = document.getElementById('q2a').value.trim();
      const q2b = document.getElementById('q2b').value.trim();
      const q2c = document.getElementById('q2c').value.trim();

      const totalText = [q2a, q2b, q2c].join(' ');
      const qtdMQP = contarMaisQuePerfeito(totalText);

      const mensagens = [];
      if (qtdMQP >= 2) {
        mensagens.push({type:'ok', text:`Detectado(s) ${qtdMQP} uso(s) aproximado(s) do pretérito mais-que-perfeito composto — atende ao requisito.`});
      } else {
        mensagens.push({type:'warn', text:`Foram detectados apenas ${qtdMQP} uso(s) do pretérito mais-que-perfeito composto. Verifique e inclua pelo menos 2 ocorrências.`});
      }

      // verificar presença de presente do subjuntivo na Questão 1 (heurística simples: procura por 'que' + verbo no presente do subjuntivo: ex: 'faça','trabalhe','seja','esteja')
      const subjuntivoIndicadores = ['que eu', 'que tu', 'que ele', 'que ela', 'que nós', 'que nós', 'que nós', 'que vocês', 'que se'];
      const subjList = ['faça','faças','faça','façamos','façam','trabalhe','trabalhem','esteja','estejamos','estejam','seja','sejamos','sejam','venha','venham','façamos'];
      const texto1 = t1.value.toLowerCase();
      let subjCount = 0;
      subjList.forEach(v => { if (texto1.includes(v)) subjCount++; });
      if (subjCount > 0) {
        mensagens.push({type:'ok', text:`Questão 1: detectado uso de formas comuns do presente do subjuntivo (heurística).`});
      } else {
        mensagens.push({type:'warn', text:`Questão 1: não foram detectadas formas comuns do presente do subjuntivo pela heurística. Verifique o uso de formas como "é importante que ...", "recomendo que ...", "que faça", etc.`});
      }

      // exibir mensagens
      mensagens.forEach(m => {
        const div = document.createElement('div');
        div.className = 'result ' + (m.type === 'ok' ? 'ok' : (m.type === 'warn' ? 'warn' : 'error'));
        div.textContent = m.text;
        feedback.appendChild(div);
      });
      // rolar para feedback
      feedback.scrollIntoView({behavior:'smooth', block:'center'});
    }

    // gerar e salvar JSON com respostas
    function baixarJSON() {
      const data = {
        aluno: document.getElementById('aluno').value,
        professor: document.getElementById('professor').value,
        data: document.getElementById('data').value,
        texto1: document.getElementById('texto1').value,
        q2a: document.getElementById('q2a').value,
        q2b: document.getElementById('q2b').value,
        q2c: document.getElementById('q2c').value,
        geradoEm: new Date().toISOString()
      };
      const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json;charset=utf-8'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${(data.aluno||'respostas')}_prova_intensivo5.json`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    // limpa campos
    function limpar(){
      if (!confirm('Tem certeza que deseja limpar todas as respostas?')) return;
      document.getElementById('provaForm').reset();
      document.getElementById('counter1').textContent = '0 / 1500';
      document.getElementById('feedback').innerHTML = '';
    }

    // pequena proteção: avisar antes de fechar se há conteúdo
    let formModified = false;
    document.getElementById('provaForm').addEventListener('input', () => { formModified = true; });
    window.addEventListener('beforeunload', (e) => {
      if (formModified) {
        e.preventDefault();
        e.returnValue = '';
      }
    });
  </script>
</body>
</html>

